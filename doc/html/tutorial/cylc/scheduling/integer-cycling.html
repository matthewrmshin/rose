



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic Cycling &mdash; Rose Documentation 2018.02.0-312-g3cbcacce documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/css/rtd-theme-fix.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Rose Documentation 2018.02.0-312-g3cbcacce documentation" href="../../../index.html"/>
        <link rel="up" title="Scheduling" href="index.html"/>
        <link rel="next" title="Date-Time Cycling" href="datetime-cycling.html"/>
        <link rel="prev" title="Graphing" href="graphing.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Rose Documentation
          

          
          </a>

          
            
            
              <div class="version">
                2018.02.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Cylc Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Scheduling</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="graphing.html">Graphing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Basic Cycling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#repeating-workflows">Repeating Workflows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inter-cycle-dependencies">Inter-Cycle Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recurrence-sections">Recurrence Sections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="datetime-cycling.html">Date-Time Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="further-scheduling.html">Further Scheduling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../runtime/index.html">Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../furthertopics/index.html">Further Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rose/index.html">Rose Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cheat-sheet.html">Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Rose API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/command-reference.html">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/configuration.html">Rose Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/environment-variables.html">Rose Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rose-bash-library.html">Rose Bash Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rose-built-in-applications.html">Rose Built-In Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rose-gtk-library.html">Rose GTK library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rose-macro.html">Rose Macro API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rose-upgrader-macros.html">Rose Upgrade Macro API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rosie-web.html">Rosie Web API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../terms.html">Rose Terms Of Use</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Rose Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Cylc Tutorial</a> &raquo;</li>
        
          <li><a href="index.html">Scheduling</a> &raquo;</li>
        
      <li>Basic Cycling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-cycling">
<span id="tutorial-integer-cycling"></span><h1>Basic Cycling<a class="headerlink" href="#basic-cycling" title="Permalink to this headline">¶</a></h1>
<p>In this section we will look at how to write <a class="reference internal" href="../../../glossary.html#term-cycling"><span class="xref std std-term">cycling</span></a> (repeating)
workflows.</p>
<div class="section" id="repeating-workflows">
<h2>Repeating Workflows<a class="headerlink" href="#repeating-workflows" title="Permalink to this headline">¶</a></h2>
<p>Often, we will want to repeat the same workflow multiple times. In Cylc this
“repetition” is called <a class="reference internal" href="../../../glossary.html#term-cycling"><span class="xref std std-term">cycling</span></a> and each repetition of the workflow is
referred to as a <a class="reference internal" href="../../../glossary.html#term-cycle"><span class="xref std std-term">cycle</span></a>.</p>
<p>Each <a class="reference internal" href="../../../glossary.html#term-cycle"><span class="xref std std-term">cycle</span></a> is given a unique label. This is called a
<a class="reference internal" href="../../../glossary.html#term-cycle-point"><span class="xref std std-term">cycle point</span></a>. For now these <a class="reference internal" href="../../../glossary.html#term-cycle-point"><span class="xref std std-term">cycle points</span></a> will be
integers <em>(they can also be dates as we will see in the next section)</em>.</p>
<p>To make a workflow repeat we must tell Cylc three things:</p>
<ol class="arabic simple">
<li>How often we want the workflow to repeat - the <a class="reference internal" href="../../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a>.</li>
<li>At what cycle point we want to start the workflow - the
<a class="reference internal" href="../../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a>.</li>
<li><em>Optionally</em> we can also tell Cylc what cycle point we want to stop the
workflow - the <a class="reference internal" href="../../../glossary.html#term-final-cycle-point"><span class="xref std std-term">final cycle point</span></a>.</li>
</ol>
<p>Let’s take the bakery example from the previous section. Bread is
produced in batches so the bakery will repeat this workflow for each
batch of bread they bake. We can make this workflow repeat with the addition
of three lines:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> [scheduling]
<span class="gi">+    cycling mode = integer</span>
<span class="gi">+    initial cycle point = 1</span>
     [[dependencies]]
<span class="gi">+        [[[P1]]]</span>
             graph = &quot;&quot;&quot;
                 purchase_ingredients =&gt; make_dough
                 pre_heat_oven &amp; make_dough =&gt; bake_bread =&gt; sell_bread &amp; clean_oven
             &quot;&quot;&quot;
</pre></div>
</div>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">cycling</span> <span class="pre">mode</span> <span class="pre">=</span> <span class="pre">integer</span></code> setting tells Cylc that we want our
<a class="reference internal" href="../../../glossary.html#term-cycle-point"><span class="xref std std-term">cycle points</span></a> to be numbered.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">cycle</span> <span class="pre">point</span> <span class="pre">=</span> <span class="pre">1</span></code> setting tells Cylc to start counting
from 1.</li>
<li><code class="docutils literal notranslate"><span class="pre">P1</span></code> is the <a class="reference internal" href="../../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a>. The <a class="reference internal" href="../../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a> within the <code class="docutils literal notranslate"><span class="pre">[[[P1]]]</span></code>
section will be repeated at each <a class="reference internal" href="../../../glossary.html#term-cycle-point"><span class="xref std std-term">cycle point</span></a>.</li>
</ul>
<p>The first three <a class="reference internal" href="../../../glossary.html#term-cycle"><span class="xref std std-term">cycles</span></a> would look like this, with the entire
workflow repeated at each cycle point:</p>
<div align="center" class="align-center"><object data="../../../_images/graphviz-d351ca2237818f0c5e6136940d5bd001e0fa72a0.svg" type="image/svg+xml">
            <p class="warning">digraph example {
size = &quot;7,15&quot;

subgraph cluster_1 {
    label = 1
    style = dashed
    &quot;pur.1&quot; [label=&quot;purchase_ingredients\n1&quot;]
    &quot;mak.1&quot; [label=&quot;make_dough\n1&quot;]
    &quot;bak.1&quot; [label=&quot;bake_bread\n1&quot;]
    &quot;sel.1&quot; [label=&quot;sell_bread\n1&quot;]
    &quot;cle.1&quot; [label=&quot;clean_oven\n1&quot;]
    &quot;pre.1&quot; [label=&quot;pre_heat_oven\n1&quot;]
}

subgraph cluster_2 {
    label = 2
    style = dashed
    &quot;pur.2&quot; [label=&quot;purchase_ingredients\n2&quot;]
    &quot;mak.2&quot; [label=&quot;make_dough\n2&quot;]
    &quot;bak.2&quot; [label=&quot;bake_bread\n2&quot;]
    &quot;sel.2&quot; [label=&quot;sell_bread\n2&quot;]
    &quot;cle.2&quot; [label=&quot;clean_oven\n2&quot;]
    &quot;pre.2&quot; [label=&quot;pre_heat_oven\n2&quot;]
}

subgraph cluster_3 {
    label = 3
    style = dashed
    &quot;pur.3&quot; [label=&quot;purchase_ingredients\n3&quot;]
    &quot;mak.3&quot; [label=&quot;make_dough\n3&quot;]
    &quot;bak.3&quot; [label=&quot;bake_bread\n3&quot;]
    &quot;sel.3&quot; [label=&quot;sell_bread\n3&quot;]
    &quot;cle.3&quot; [label=&quot;clean_oven\n3&quot;]
    &quot;pre.3&quot; [label=&quot;pre_heat_oven\n3&quot;]
}

&quot;pur.1&quot; -&gt; &quot;mak.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;sel.1&quot;
&quot;pre.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;cle.1&quot;
&quot;pur.2&quot; -&gt; &quot;mak.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;sel.2&quot;
&quot;pre.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;cle.2&quot;
&quot;pur.3&quot; -&gt; &quot;mak.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;sel.3&quot;
&quot;pre.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;cle.3&quot;
}</p></object>
</div>
<p>Note the numbers under each task which represent the <a class="reference internal" href="../../../glossary.html#term-cycle-point"><span class="xref std std-term">cycle point</span></a> each
task is in.</p>
</div>
<div class="section" id="inter-cycle-dependencies">
<h2>Inter-Cycle Dependencies<a class="headerlink" href="#inter-cycle-dependencies" title="Permalink to this headline">¶</a></h2>
<p>We’ve just seen how to write a workflow that repeats every <a class="reference internal" href="../../../glossary.html#term-cycle"><span class="xref std std-term">cycle</span></a>.</p>
<p>Cylc runs tasks as soon as their dependencies are met so cycles are not
necessarily run in order. This could cause problems, for instance we could
find ourselves pre-heating the oven in one cycle whist we are still
cleaning it in another.</p>
<p>To resolve this we must add <a class="reference internal" href="../../../glossary.html#term-dependency"><span class="xref std std-term">dependencies</span></a> <em>between</em> the
cycles. We do this by adding lines to the <a class="reference internal" href="../../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a>. Tasks in the
previous cycle can be referred to by suffixing their name with <code class="docutils literal notranslate"><span class="pre">[-P1]</span></code>,
for example. So to ensure the <code class="docutils literal notranslate"><span class="pre">clean_oven</span></code> task has been completed before
the start of the <code class="docutils literal notranslate"><span class="pre">pre_heat_oven</span></code> task in the next cycle, we would write
the following dependency:</p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="kd">clean_oven</span>[<span class="nb">-P1</span>] <span class="o">=&gt;</span> <span class="kd">pre_heat_oven</span>
</pre></div>
</div>
<p>This dependency can be added to the suite by adding it to the other graph
lines:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> [scheduling]
     cycling mode = integer
     initial cycle point = 1
     [[dependencies]]
         [[[P1]]]
             graph = &quot;&quot;&quot;
                 purchase_ingredients =&gt; make_dough
                 pre_heat_oven &amp; make_dough =&gt; bake_bread =&gt; sell_bread &amp; clean_oven
<span class="gi">+                clean_oven[-P1] =&gt; pre_heat_oven</span>
             &quot;&quot;&quot;
</pre></div>
</div>
<p>The resulting suite would look like this:</p>
<div align="center" class="align-center"><object data="../../../_images/graphviz-b56d01a21fb43eab1faacaba37601d231a7eb5a8.svg" type="image/svg+xml">
            <p class="warning">digraph example {
size = &quot;7,15&quot;

subgraph cluster_1 {
    label = 1
    style = dashed
    &quot;pur.1&quot; [label=&quot;purchase_ingredients\n1&quot;]
    &quot;mak.1&quot; [label=&quot;make_dough\n1&quot;]
    &quot;bak.1&quot; [label=&quot;bake_bread\n1&quot;]
    &quot;sel.1&quot; [label=&quot;sell_bread\n1&quot;]
    &quot;cle.1&quot; [label=&quot;clean_oven\n1&quot;]
    &quot;pre.1&quot; [label=&quot;pre_heat_oven\n1&quot;]
}

subgraph cluster_2 {
    label = 2
    style = dashed
    &quot;pur.2&quot; [label=&quot;purchase_ingredients\n2&quot;]
    &quot;mak.2&quot; [label=&quot;make_dough\n2&quot;]
    &quot;bak.2&quot; [label=&quot;bake_bread\n2&quot;]
    &quot;sel.2&quot; [label=&quot;sell_bread\n2&quot;]
    &quot;cle.2&quot; [label=&quot;clean_oven\n2&quot;]
    &quot;pre.2&quot; [label=&quot;pre_heat_oven\n2&quot;]
}

subgraph cluster_3 {
    label = 3
    style = dashed
    &quot;pur.3&quot; [label=&quot;purchase_ingredients\n3&quot;]
    &quot;mak.3&quot; [label=&quot;make_dough\n3&quot;]
    &quot;bak.3&quot; [label=&quot;bake_bread\n3&quot;]
    &quot;sel.3&quot; [label=&quot;sell_bread\n3&quot;]
    &quot;cle.3&quot; [label=&quot;clean_oven\n3&quot;]
    &quot;pre.3&quot; [label=&quot;pre_heat_oven\n3&quot;]
}

&quot;pur.1&quot; -&gt; &quot;mak.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;sel.1&quot;
&quot;pre.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;cle.1&quot;
&quot;cle.1&quot; -&gt; &quot;pre.2&quot;
&quot;pur.2&quot; -&gt; &quot;mak.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;sel.2&quot;
&quot;pre.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;cle.2&quot;
&quot;cle.2&quot; -&gt; &quot;pre.3&quot;
&quot;pur.3&quot; -&gt; &quot;mak.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;sel.3&quot;
&quot;pre.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;cle.3&quot;
}</p></object>
</div>
<p>Adding this dependency “strings together” the cycles, forcing them to run in
order. We refer to dependencies between cycles as
<a class="reference internal" href="../../../glossary.html#term-inter-cycle-dependency"><span class="xref std std-term">inter-cycle dependencies</span></a>.</p>
<p>In the dependency the <code class="docutils literal notranslate"><span class="pre">[-P1]</span></code> suffix tells Cylc that we are referring to a
task in the previous cycle. Equally <code class="docutils literal notranslate"><span class="pre">[-P2]</span></code> would refer to a task two cycles
ago.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">purchase_ingredients</span></code> task has no arrows pointing at it
meaning that it has no dependencies. Consequently the <code class="docutils literal notranslate"><span class="pre">purchase_ingredients</span></code>
tasks will all run straight away. This could cause our bakery to run into
cash-flow problems as they would be purchasing ingredients well in advance
of using them.</p>
<p>To solve this, but still make sure that they never run out of
ingredients, the bakery wants to purchase ingredients two batches ahead.
This can be achieved by adding the following dependency:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> [scheduling]
     cycling mode = integer
     initial cycle point = 1
     [[dependencies]]
         [[[P1]]]
             graph = &quot;&quot;&quot;
                 purchase_ingredients =&gt; make_dough
                 pre_heat_oven &amp; make_dough =&gt; bake_bread =&gt; sell_bread &amp; clean_oven
                 clean_oven[-P1] =&gt; pre_heat_oven
<span class="gi">+                sell_bread[-P2] =&gt; purchase_ingredients</span>
             &quot;&quot;&quot;
</pre></div>
</div>
<p>This dependency means that the <code class="docutils literal notranslate"><span class="pre">purchase_ingredients</span></code> task will run after the
<code class="docutils literal notranslate"><span class="pre">sell_bread</span></code> task two cycles before.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[-P2]</span></code> suffix is used to reference a task two cycles before. For the
first two cycles this doesn’t make sense as there was no cycle two cycles
before, so this dependency will be ignored.</p>
<p class="last">Any inter-cycle dependencies stretching back to before the
<a class="reference internal" href="../../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a> will be ignored.</p>
</div>
<div align="center" class="align-center"><object data="../../../_images/graphviz-4ba68edd4bbc6129ab201e342e7b260d1d9dfd59.svg" type="image/svg+xml">
            <p class="warning">digraph example {
size = &quot;4.5,15&quot;

subgraph cluster_1 {
    label = 1
    style = dashed
    &quot;pur.1&quot; [label=&quot;purchase_ingredients\n1&quot;]
    &quot;mak.1&quot; [label=&quot;make_dough\n1&quot;]
    &quot;bak.1&quot; [label=&quot;bake_bread\n1&quot;]
    &quot;sel.1&quot; [label=&quot;sell_bread\n1&quot;]
    &quot;cle.1&quot; [label=&quot;clean_oven\n1&quot;]
    &quot;pre.1&quot; [label=&quot;pre_heat_oven\n1&quot;]
}

subgraph cluster_2 {
    label = 2
    style = dashed
    &quot;pur.2&quot; [label=&quot;purchase_ingredients\n2&quot;]
    &quot;mak.2&quot; [label=&quot;make_dough\n2&quot;]
    &quot;bak.2&quot; [label=&quot;bake_bread\n2&quot;]
    &quot;sel.2&quot; [label=&quot;sell_bread\n2&quot;]
    &quot;cle.2&quot; [label=&quot;clean_oven\n2&quot;]
    &quot;pre.2&quot; [label=&quot;pre_heat_oven\n2&quot;]
}

subgraph cluster_3 {
    label = 3
    style = dashed
    &quot;pur.3&quot; [label=&quot;purchase_ingredients\n3&quot;]
    &quot;mak.3&quot; [label=&quot;make_dough\n3&quot;]
    &quot;bak.3&quot; [label=&quot;bake_bread\n3&quot;]
    &quot;sel.3&quot; [label=&quot;sell_bread\n3&quot;]
    &quot;cle.3&quot; [label=&quot;clean_oven\n3&quot;]
    &quot;pre.3&quot; [label=&quot;pre_heat_oven\n3&quot;]
}

subgraph cluster_4 {
    label = 4
    style = dashed
    &quot;pur.4&quot; [label=&quot;purchase_ingredients\n4&quot;]
    &quot;mak.4&quot; [label=&quot;make_dough\n4&quot;]
    &quot;bak.4&quot; [label=&quot;bake_bread\n4&quot;]
    &quot;sel.4&quot; [label=&quot;sell_bread\n4&quot;]
    &quot;cle.4&quot; [label=&quot;clean_oven\n4&quot;]
    &quot;pre.4&quot; [label=&quot;pre_heat_oven\n4&quot;]
}

&quot;pur.1&quot; -&gt; &quot;mak.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;sel.1&quot;
&quot;pre.1&quot; -&gt; &quot;bak.1&quot; -&gt; &quot;cle.1&quot;
&quot;cle.1&quot; -&gt; &quot;pre.2&quot;
&quot;sel.1&quot; -&gt; &quot;pur.3&quot;
&quot;pur.2&quot; -&gt; &quot;mak.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;sel.2&quot;
&quot;pre.2&quot; -&gt; &quot;bak.2&quot; -&gt; &quot;cle.2&quot;
&quot;cle.2&quot; -&gt; &quot;pre.3&quot;
&quot;sel.2&quot; -&gt; &quot;pur.4&quot;
&quot;pur.3&quot; -&gt; &quot;mak.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;sel.3&quot;
&quot;pre.3&quot; -&gt; &quot;bak.3&quot; -&gt; &quot;cle.3&quot;
&quot;cle.3&quot; -&gt; &quot;pre.4&quot;
&quot;pur.4&quot; -&gt; &quot;mak.4&quot; -&gt; &quot;bak.4&quot; -&gt; &quot;sel.4&quot;
&quot;pre.4&quot; -&gt; &quot;bak.4&quot; -&gt; &quot;cle.4&quot;
}</p></object>
</div>
</div>
<div class="section" id="recurrence-sections">
<h2>Recurrence Sections<a class="headerlink" href="#recurrence-sections" title="Permalink to this headline">¶</a></h2>
<p>In the previous examples we made the workflow repeat by placing the graph
within the <code class="docutils literal notranslate"><span class="pre">[[[P1]]]</span></code> section. Here <code class="docutils literal notranslate"><span class="pre">P1</span></code> is a <a class="reference internal" href="../../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a> meaning
repeat every cycle, where <code class="docutils literal notranslate"><span class="pre">P1</span></code> means every cycle, <code class="docutils literal notranslate"><span class="pre">P2</span></code> means every
<em>other</em> cycle, and so on. To build more complex workflows we can use multiple
recurrences:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nt">[[dependencies]]</span>
        <span class="nt">[[[P1]]]</span>  <span class="c1"># Repeat every cycle.</span>
            <span class="nv">graph</span><span class="s"> </span><span class="o">=</span> <span class="kd">foo</span>
        <span class="nt">[[[P2]]]</span>  <span class="c1"># Repeat every second cycle.</span>
            <span class="nv">graph</span><span class="s"> </span><span class="o">=</span> <span class="kd">bar</span>
        <span class="nt">[[[P3]]]</span>  <span class="c1"># Repeat every third cycle.</span>
            <span class="nv">graph</span><span class="s"> </span><span class="o">=</span> <span class="kd">baz</span>
</pre></div>
</div>
<div align="center" class="align-center"><object data="../../../_images/graphviz-7428326f1c901a50f51a390741e4ccdb4117fa9b.svg" type="image/svg+xml">
            <p class="warning">digraph example {
subgraph cluster_1 {
    label = 1
    style = dashed
    &quot;foo.1&quot; [label=&quot;foo\n1&quot;]
    &quot;bar.1&quot; [label=&quot;bar\n1&quot;]
    &quot;baz.1&quot; [label=&quot;baz\n1&quot;]
}

subgraph cluster_2 {
    label = 2
    style = dashed
    &quot;foo.2&quot; [label=&quot;foo\n2&quot;]
}

subgraph cluster_3 {
    label = 3
    style = dashed
    &quot;foo.3&quot; [label=&quot;foo\n3&quot;]
    &quot;bar.3&quot; [label=&quot;bar\n3&quot;]
}
}</p></object>
</div>
<p>By default recurrences start at the <a class="reference internal" href="../../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a>, however it
is possible to make them start at an arbitrary cycle point. This is done by
writing the cycle point and the recurrence separated by a forward slash
(<code class="docutils literal notranslate"><span class="pre">/</span></code>), e.g. <code class="docutils literal notranslate"><span class="pre">5/P3</span></code> means repeat every third cycle starting <em>from</em> cycle
number 5.</p>
<p>The start point of a recurrence can also be defined as an offset from the
<a class="reference internal" href="../../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a>, e.g. <code class="docutils literal notranslate"><span class="pre">+P5/P3</span></code> means repeat every third cycle
starting 5 cycles <em>after</em> the initial cycle point.</p>
<div class="note admonition">
<p class="first admonition-title">Practical</p>
<p class="rubric">In this practical we will take the <a class="reference internal" href="../../../glossary.html#term-cylc-suite"><span class="xref std std-term">suite</span></a>
we wrote in the previous section and turn it into a
<a class="reference internal" href="../../../glossary.html#term-cycling"><span class="xref std std-term">cycling suite</span></a>.</p>
<p>If you have not completed the previous practical use the following code for
your <code class="docutils literal notranslate"><span class="pre">suite.rc</span></code> file.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[dependencies]]</span>
        <span class="nv">graph</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">pub</span> <span class="o">=&gt;</span> <span class="kd">bar</span> <span class="o">=&gt;</span> <span class="kd">baz</span> <span class="o">&amp;</span> <span class="kd">wop</span>
            <span class="kd">baz</span> <span class="o">=&gt;</span> <span class="kd">qux</span>
        <span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<ol class="last arabic">
<li><p class="first"><strong>Create a new suite.</strong></p>
<p>Within your <code class="docutils literal notranslate"><span class="pre">~/cylc-run/</span></code> directory create a new (sub-)directory called
<code class="docutils literal notranslate"><span class="pre">integer-cycling</span></code> and move into it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir ~/cylc-run/integer-cycling
<span class="nb">cd</span> ~/cylc-run/integer-cycling
</pre></div>
</div>
<p>Copy the above code into a <code class="docutils literal notranslate"><span class="pre">suite.rc</span></code> file in that directory.</p>
</li>
<li><p class="first"><strong>Make the suite cycle.</strong></p>
<p>Add in the following lines.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> [scheduling]
<span class="gi">+    cycling mode = integer</span>
<span class="gi">+    initial cycle point = 1</span>
     [[dependencies]]
<span class="gi">+        [[[P1]]]</span>
             graph = &quot;&quot;&quot;
                 foo &amp; pub =&gt; bar =&gt; baz &amp; wop
                 baz =&gt; qux
             &quot;&quot;&quot;
</pre></div>
</div>
</li>
<li><p class="first"><strong>Visualise the suite.</strong></p>
<p>Try visualising the suite using <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cylc graph .
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>You can get Cylc graph to draw dotted boxes around the cycles by
clicking the “Organise by cycle point” button on the toolbar:</p>
<img alt="../../../_images/cylc-graph-cluster.png" class="last align-center" src="../../../_images/cylc-graph-cluster.png" />
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code> displays the first three cycles of a suite.
You can tell <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code> to visualise the cycles between two points
by providing them as arguments, for instance the following example
would show all cycles between <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">5</span></code> (inclusive):</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cylc</span> <span class="n">graph</span> <span class="o">.</span> <span class="mi">1</span> <span class="mi">5</span> <span class="o">&amp;</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first"><strong>Add another recurrence.</strong></p>
<p>Suppose we wanted the <code class="docutils literal notranslate"><span class="pre">qux</span></code> task to run every <em>other</em> cycle as opposed
to every cycle. We can do this by adding another recurrence.</p>
<p>Make the following changes to your <code class="docutils literal notranslate"><span class="pre">suite.rc</span></code> file.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> [scheduling]
     cycling mode = integer
     initial cycle point = 1
     [[dependencies]]
         [[[P1]]]
             graph = &quot;&quot;&quot;
                 foo &amp; pub =&gt; bar =&gt; baz &amp; wop
<span class="gd">-                baz =&gt; qux</span>
             &quot;&quot;&quot;
<span class="gi">+        [[[P2]]]</span>
<span class="gi">+            graph = &quot;&quot;&quot;</span>
<span class="gi">+                baz =&gt; qux</span>
<span class="gi">+            &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code> to see the effect this has on the workflow.</p>
</li>
<li><p class="first"><strong>Inter-cycle dependencies.</strong></p>
<p>Next we need to add some inter-cycle dependencies. We are going to add
three inter-cycle dependencies:</p>
<ol class="arabic simple">
<li>Between <code class="docutils literal notranslate"><span class="pre">wop</span></code> from the previous cycle and <code class="docutils literal notranslate"><span class="pre">pub</span></code>.</li>
<li>Between <code class="docutils literal notranslate"><span class="pre">baz</span></code> from the previous cycle and <code class="docutils literal notranslate"><span class="pre">foo</span></code>
<em>every odd cycle</em>.</li>
<li>Between <code class="docutils literal notranslate"><span class="pre">qux</span></code> from the previous cycle and <code class="docutils literal notranslate"><span class="pre">foo</span></code>
<em>every even cycle</em>.</li>
</ol>
<p>Have a go at adding inter-cycle dependencies to your <code class="docutils literal notranslate"><span class="pre">suite.rc</span></code> file to
make your workflow match the diagram below.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">P2</span></code> means every odd cycle.</li>
<li><code class="docutils literal notranslate"><span class="pre">2/P2</span></code> means every even cycle.</li>
</ul>
</div>
<div align="center" class="align-center"><object data="../../../_images/graphviz-fb84cf0bc9b13fef83f693d87fe447be78c77fb5.svg" type="image/svg+xml">
            <p class="warning">digraph example {
 size = &quot;4.5,7&quot;

 subgraph cluster_1 {
     label = 1
     style = dashed
     &quot;foo.1&quot; [label=&quot;foo\n1&quot;]
     &quot;bar.1&quot; [label=&quot;bar\n1&quot;]
     &quot;baz.1&quot; [label=&quot;baz\n1&quot;]
     &quot;wop.1&quot; [label=&quot;wop\n1&quot;]
     &quot;pub.1&quot; [label=&quot;pub\n1&quot;]
     &quot;qux.1&quot; [label=&quot;qux\n1&quot;]
 }

 subgraph cluster_2 {
     label = 2
     style = dashed
     &quot;foo.2&quot; [label=&quot;foo\n2&quot;]
     &quot;bar.2&quot; [label=&quot;bar\n2&quot;]
     &quot;baz.2&quot; [label=&quot;baz\n2&quot;]
     &quot;wop.2&quot; [label=&quot;wop\n2&quot;]
     &quot;pub.2&quot; [label=&quot;pub\n2&quot;]
 }

 subgraph cluster_3 {
     label = 3
     style = dashed
     &quot;foo.3&quot; [label=&quot;foo\n3&quot;]
     &quot;bar.3&quot; [label=&quot;bar\n3&quot;]
     &quot;baz.3&quot; [label=&quot;baz\n3&quot;]
     &quot;wop.3&quot; [label=&quot;wop\n3&quot;]
     &quot;pub.3&quot; [label=&quot;pub\n3&quot;]
     &quot;qux.3&quot; [label=&quot;qux\n3&quot;]
 }

 &quot;foo.1&quot; -&gt; &quot;bar.1&quot; -&gt; &quot;wop.1&quot;
 &quot;bar.1&quot; -&gt; &quot;baz.1&quot;
 &quot;pub.1&quot; -&gt; &quot;bar.1&quot;
 &quot;foo.2&quot; -&gt; &quot;bar.2&quot; -&gt; &quot;wop.2&quot;
 &quot;bar.2&quot; -&gt; &quot;baz.2&quot;
 &quot;pub.2&quot; -&gt; &quot;bar.2&quot;
 &quot;foo.3&quot; -&gt; &quot;bar.3&quot; -&gt; &quot;wop.3&quot;
 &quot;bar.3&quot; -&gt; &quot;baz.3&quot;
 &quot;pub.3&quot; -&gt; &quot;bar.3&quot;
 &quot;baz.1&quot; -&gt; &quot;qux.1&quot; -&gt; &quot;foo.2&quot;
 &quot;baz.3&quot; -&gt; &quot;qux.3&quot;
 &quot;baz.2&quot; -&gt; &quot;foo.3&quot;
 &quot;wop.1&quot; -&gt; &quot;pub.2&quot;
 &quot;wop.2&quot; -&gt; &quot;pub.3&quot;
}</p></object>
</div>
<div class="spoiler warning admonition">
<p class="first admonition-title">Solution</p>
<div class="last highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nt">[[dependencies]]</span>
        <span class="nt">[[[P1]]]</span>
            <span class="nv">graph</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
                <span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">pub</span> <span class="o">=&gt;</span> <span class="kd">bar</span> <span class="o">=&gt;</span> <span class="kd">baz</span> <span class="o">&amp;</span> <span class="kd">wop</span>
                <span class="kd">wop</span>[<span class="nb">-P1</span>] <span class="o">=&gt;</span> <span class="kd">pub</span>  <span class="c1"># (1)</span>
            <span class="s2">&quot;&quot;&quot;</span>
        <span class="nt">[[[P2]]]</span>
            <span class="nv">graph</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
                <span class="kd">baz</span> <span class="o">=&gt;</span> <span class="kd">qux</span>
                <span class="kd">baz</span>[<span class="nb">-P1</span>] <span class="o">=&gt;</span> <span class="kd">foo</span>  <span class="c1"># (2)</span>
            <span class="s2">&quot;&quot;&quot;</span>
        <span class="nt">[[[+P2/P2]]]</span>
            <span class="nv">graph</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
                <span class="kd">qux</span>[<span class="nb">-P1</span>] <span class="o">=&gt;</span> <span class="kd">foo</span>  <span class="c1"># (3)</span>
            <span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="datetime-cycling.html" class="btn btn-neutral float-right" title="Date-Time Cycling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="graphing.html" class="btn btn-neutral" title="Graphing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright : British Crown Copyright 2012-8 Met Office. See Terms of Use. This document is released under the Open Government Licence.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2018.02.0-312-g3cbcacce',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/js/minicylc.js"></script>
      <script type="text/javascript" src="../../../_static/js/spoiler.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../../_static/js/rtd-theme-extensions.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>