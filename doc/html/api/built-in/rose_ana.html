



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rose_ana &mdash; Rose Documentation 2018.02.0-312-g3cbcacce documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/rtd-theme-fix.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Rose Documentation 2018.02.0-312-g3cbcacce documentation" href="../../index.html"/>
        <link rel="up" title="Rose Built-In Applications" href="../rose-built-in-applications.html"/>
        <link rel="next" title="rose_arch" href="rose_arch.html"/>
        <link rel="prev" title="fcm_make" href="fcm_make.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Rose Documentation
          

          
          </a>

          
            
            
              <div class="version">
                2018.02.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/cylc/index.html">Cylc Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/rose/index.html">Rose Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cheat-sheet.html">Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Rose API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../command-reference.html">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Rose Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environment-variables.html">Rose Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rose-bash-library.html">Rose Bash Library</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../rose-built-in-applications.html">Rose Built-In Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fcm_make.html"><code class="docutils literal notranslate"><span class="pre">fcm_make</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">rose_ana</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#invocation">Invocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-modules">Analysis Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-classes">Analysis Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rose_arch.html"><code class="docutils literal notranslate"><span class="pre">rose_arch</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rose_bunch.html"><code class="docutils literal notranslate"><span class="pre">rose_bunch</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rose_prune.html"><code class="docutils literal notranslate"><span class="pre">rose_prune</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rose-gtk-library.html">Rose GTK library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rose-macro.html">Rose Macro API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rose-upgrader-macros.html">Rose Upgrade Macro API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rosie-web.html">Rosie Web API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../terms.html">Rose Terms Of Use</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Rose Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../rose-built-in-applications.html">Rose Built-In Applications</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">rose_ana</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rose-ana">
<h1><code class="docutils literal notranslate"><span class="pre">rose_ana</span></code><a class="headerlink" href="#rose-ana" title="Permalink to this headline">¶</a></h1>
<p>This built-in application runs the <code class="docutils literal notranslate"><span class="pre">rose-ana</span></code> analysis engine.</p>
<p><code class="docutils literal notranslate"><span class="pre">rose-ana</span></code> performs various configurable analysis steps. For example
a common usage is to compare two files and report whether they differ
or not. It can write the details of any comparisons it runs to a
database in the suite’s log directory to assist with any automated
updating of control data.</p>
<div class="section" id="invocation">
<h2>Invocation<a class="headerlink" href="#invocation" title="Permalink to this headline">¶</a></h2>
<p>In automatic selection mode, this built-in application will be
invoked automatically if a task has a name that starts with <code class="docutils literal notranslate"><span class="pre">rose_ana*</span></code>.</p>
</div>
<div class="section" id="analysis-modules">
<h2>Analysis Modules<a class="headerlink" href="#analysis-modules" title="Permalink to this headline">¶</a></h2>
<p>The built-in application will search for suitable analysis modules to
load firstly in the <code class="docutils literal notranslate"><span class="pre">ana</span></code> subdirectory of the <code class="docutils literal notranslate"><span class="pre">rose-ana</span></code> app, then in
the <code class="docutils literal notranslate"><span class="pre">ana</span></code> subdirectory of the top-most suite directory. Any
additional directories to search (for example a site-wide central
directory) may be specified by setting the
<a class="reference internal" href="../configuration/site-and-user.html#rose:conf:rose.conf[rose-ana]method-path" title="rose:conf:rose.conf[rose-ana]method-path"><code class="xref rose rose-conf docutils literal notranslate"><span class="pre">rose.conf[rose-ana]method-path</span></code></a> variable. Finally the
<code class="docutils literal notranslate"><span class="pre">ana_builtins</span></code> subdirectory of the Rose installation itself contains
any built-in comparisons.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The application configuration should contain configuration sections which
describe an analysis step. These sections must follow a particular format:</p>
<ul class="simple">
<li>the name must begin with <code class="docutils literal notranslate"><span class="pre">ana:</span></code>. This is required for <code class="docutils literal notranslate"><span class="pre">rose-ana</span></code> to
recognise it as a valid section.</li>
<li>the next part gives the name of the class within one of the analysis
modules, including namespace information; for example to use the built-in
<code class="docutils literal notranslate"><span class="pre">FilePattern</span></code> class from the <code class="docutils literal notranslate"><span class="pre">grepper</span></code> module you would provide the
name <code class="docutils literal notranslate"><span class="pre">grepper.FilePattern</span></code>.</li>
<li>finally an expression within parentheses which may contain any string;
this should be used to make comparisons using the same class unique, but
can otherwise simply act as a description or note.</li>
</ul>
<p>The content within each of these sections consists of a series of key-value
option pairs, just like other standard Rose apps. However the availability
of options for a given section is specified and controlled by the <em>class</em>
rather than the meta-data. This makes it easy to provide your own analysis
modules without requiring changes to Rose itself.</p>
<p>Therefore you should consult the documentation or source code of the
analysis module you wish to use for details of which options it supports.
Additionally, some special treatment is applied to all options depending
on what they contain:</p>
<dl class="docutils">
<dt>Environment Variables</dt>
<dd>If the option contains any words prefixed by <code class="docutils literal notranslate"><span class="pre">$</span></code>
they will be substituted for the equivalent environment variable, if one
is available.</dd>
<dt>Lists</dt>
<dd>If the option contains newlines it will be returned as a list of
strings automatically.</dd>
<dt>Argument substitution</dt>
<dd>If the option contains one or more pairs of braces (<code class="docutils literal notranslate"><span class="pre">{}</span></code>) the option
will be returned multiple times with the parentheses substituted once for
each argument passed to <a class="reference internal" href="../command-reference.html#command-rose-task-run"><span class="std std-ref">rose task-run</span></a></dd>
</dl>
<p>The app may also define a configuration section, <code class="docutils literal notranslate"><span class="pre">[ana:config]</span></code>, whose
key-value pairs define app-wide settings that are passed through to the
analysis classes. In the same way that the task options are dependent on
the class definition, interpretation of the <code class="docutils literal notranslate"><span class="pre">config</span></code> options is done by the
class(es), so their documentation or source code should be consulted for
details.</p>
<dl class="app">
<dt id="rose:app:rose_ana">
<em class="property">Rose App </em><code class="descname">rose_ana</code><a class="headerlink" href="#rose:app:rose_ana" title="Permalink to this definition">¶</a></dt>
<dd><dl class="conf">
<dt id="rose:conf:rose_ana[ana:config]">
<em class="property">Config </em><code class="descname">[ana:config]</code><a class="headerlink" href="#rose:conf:rose_ana[ana:config]" title="Permalink to this definition">¶</a></dt>
<dd><dl class="conf">
<dt id="rose:conf:rose_ana[ana:config]grepper-report-limit">
<em class="property">Config </em><code class="descname">grepper-report-limit</code><a class="headerlink" href="#rose:conf:rose_ana[ana:config]grepper-report-limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Limits the number of lines printed when using the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">rose.apps.ana_builtin.grepper</span></code> analysis class.</p>
</dd></dl>

<dl class="conf">
<dt id="rose:conf:rose_ana[ana:config]skip-if-all-files-missing">
<em class="property">Config </em><code class="descname">skip-if-all-files-missing</code><a class="headerlink" href="#rose:conf:rose_ana[ana:config]skip-if-all-files-missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Causes the <code class="xref py py-mod docutils literal notranslate"><span class="pre">rose.apps.ana_builtin.grepper</span></code> class to pass
if all files to be compared are missing.</p>
</dd></dl>

<dl class="conf">
<dt id="rose:conf:rose_ana[ana:config]kgo-database">
<em class="property">Config </em><code class="descname">kgo-database</code><a class="headerlink" href="#rose:conf:rose_ana[ana:config]kgo-database" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns on the <a class="reference internal" href="../../tutorial/rose/furthertopics/rose-stem.html#the-rose-ana-comparison-database"><span class="std std-ref">Rose Ana Comparison Database</span></a>.</p>
</dd></dl>

</dd></dl>

<dl class="conf">
<dt id="rose:conf:rose_ana[ana:ANALYSIS_CLASS]">
<em class="property">Config </em><code class="descname">[ana:ANALYSIS_CLASS]</code><a class="headerlink" href="#rose:conf:rose_ana[ana:ANALYSIS_CLASS]" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a new analysis step. <code class="docutils literal notranslate"><span class="pre">ANALYSIS_CLASS</span></code> is the name of
the analysis class e.g. <code class="docutils literal notranslate"><span class="pre">grepper.FilePattern</span></code>.</p>
<dl class="conf">
<dt id="rose:conf:rose_ana[ana:ANALYSIS_CLASS]KEY">
<em class="property">Config </em><code class="descname">KEY</code><em class="property">= VALUE</em><a class="headerlink" href="#rose:conf:rose_ana[ana:ANALYSIS_CLASS]KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an argument to <code class="docutils literal notranslate"><span class="pre">ANALYSIS_CLASS</span></code>.</p>
</dd></dl>

</dd></dl>

</dd></dl>

</div>
<div class="section" id="analysis-classes">
<h2>Analysis Classes<a class="headerlink" href="#analysis-classes" title="Permalink to this headline">¶</a></h2>
<p>There is one built-in module of analysis classes called <code class="docutils literal notranslate"><span class="pre">grepper</span></code>.</p>
<dl class="class">
<dt id="rose.apps.ana_builtin.grepper.FileCommandPattern">
<em class="property">class </em><code class="descclassname">rose.apps.ana_builtin.grepper.</code><code class="descname">FileCommandPattern</code><span class="sig-paren">(</span><em>parent_app</em>, <em>task_options</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/rose/apps/ana_builtin/grepper.html#FileCommandPattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rose.apps.ana_builtin.grepper.FileCommandPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for occurences of a particular expression or value in the standard
output from a command applied to two or more files.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><dl class="first last docutils">
<dt>files (optional):</dt>
<dd>Same as previous tasks.</dd>
<dt>kgo_file:</dt>
<dd>Same as previous tasks.</dd>
<dt>pattern:</dt>
<dd>Same as previous tasks.</dd>
<dt>tolerance (optional):</dt>
<dd>Same as previous tasks.</dd>
<dt>command:</dt>
<dd>The command to run; it should contain a Python style format
specifier to be expanded using the list of files above.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="rose.apps.ana_builtin.grepper.FilePattern">
<em class="property">class </em><code class="descclassname">rose.apps.ana_builtin.grepper.</code><code class="descname">FilePattern</code><span class="sig-paren">(</span><em>parent_app</em>, <em>task_options</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/rose/apps/ana_builtin/grepper.html#FilePattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rose.apps.ana_builtin.grepper.FilePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for occurences of a particular expression or value within the
contents of two or more files.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><dl class="first last docutils">
<dt>files (optional):</dt>
<dd>Same as previous tasks.</dd>
<dt>kgo_file:</dt>
<dd>Same as previous tasks.</dd>
<dt>pattern:</dt>
<dd>The regular expression to search for in the files. The
expression should include one or more capture groups; each
of these will be compared between the files any time the
pattern occurs.</dd>
<dt>tolerance (optional):</dt>
<dd>By default the above comparisons will be compared exactly,
but if this argument is specified they will be converted to
float values and compared according to the given tolerance.
If this tolerance ends in % it will be interpreted as a
relative tolerance (otherwise absolute).</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="rose.apps.ana_builtin.grepper.SingleCommandPattern">
<em class="property">class </em><code class="descclassname">rose.apps.ana_builtin.grepper.</code><code class="descname">SingleCommandPattern</code><span class="sig-paren">(</span><em>parent_app</em>, <em>task_options</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/rose/apps/ana_builtin/grepper.html#SingleCommandPattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rose.apps.ana_builtin.grepper.SingleCommandPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a single command and then pass/fail depending on the presence of a
particular expression in that command’s standard output.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><dl class="first last docutils">
<dt>files (optional):</dt>
<dd>Same as previous task. command - same as previous task.</dd>
<dt>kgo_file:</dt>
<dd>Same as previous task.</dd>
<dt>pattern:</dt>
<dd>The regular expression to search for in the stdout from the command.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="rose.apps.ana_builtin.grepper.SingleCommandStatus">
<em class="property">class </em><code class="descclassname">rose.apps.ana_builtin.grepper.</code><code class="descname">SingleCommandStatus</code><span class="sig-paren">(</span><em>parent_app</em>, <em>task_options</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/rose/apps/ana_builtin/grepper.html#SingleCommandStatus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rose.apps.ana_builtin.grepper.SingleCommandStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a shell command, passing or failing depending on the exit
status of that command.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><dl class="first last docutils">
<dt>files (optional):</dt>
<dd>A newline-separated list of filenames which may appear
in the command.</dd>
<dt>command:</dt>
<dd>The command to run; if it contains Python style
format specifiers these will be expanded using the list of
files above (if provided).</dd>
<dt>kgo_file:</dt>
<dd>If the list of files above was provided gives the
(0-based) index of the file holding the “kgo” or “control”
output for use with the comparisons database (if active).</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rose_arch.html" class="btn btn-neutral float-right" title="rose_arch" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fcm_make.html" class="btn btn-neutral" title="fcm_make" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright : British Crown Copyright 2012-8 Met Office. See Terms of Use. This document is released under the Open Government Licence.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2018.02.0-312-g3cbcacce',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/js/minicylc.js"></script>
      <script type="text/javascript" src="../../_static/js/spoiler.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../_static/js/rtd-theme-extensions.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>